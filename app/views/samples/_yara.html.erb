<style type="text/css"> .centerDiv { width: 17%; height:20px; margin: 0 auto;  text-align: center;} </style>

<div class="tab-pane active" id="#signatures">
    <div class="container">
    <h5>Add new yara signature <%= link_to '', samples_new_yara_path, :class => 'glyphicon glyphicon-plus btn btn-success' %></h5>
    <h5>Scan samples with available rules <%= link_to '', samples_list_path, :class => 'glyphicon glyphicon-refresh btn btn-info' %></h5>
      </div>
  <% @rules = Dir["app/assets/yara/*.yar"] %>
  <div class="container">
    <!-- Default panel contents -->
    <div class="panel panel-default">
    <div class="panel-heading">Rule Set</div>
    <table class="table table-striped">
        <thead>
        <tr>
          <th>Name</th>
          <th>Remove</th>
        </tr>
        </thead>
        <tbody>
            <% @rules.each do |x| %>
            <% name = File.basename(x) %>
            <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#scrap-modal"><%= name %></button></td>
            <!-- Modal -->
                <div class="modal fade" id="scrap-modal" tabindex="-1" role="dialog" aria-labelledby="editLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                            <h4 class="modal-title" id="editLabel">Rule Editor</h4>
                        </div>
                        <div class="modal-body">
                            <form role="form" action="add_rule" enctype="multipart/form-data" method="post" onsubmit="window.location.reload();">
                            <input type="text" class="form-control" name="rule_name" value="<%= name %>" />
                            <textarea class="form-control" rows="10" name="rule_text" id="content"><%= File.open(x, 'rb').read %></textarea>
                            <button type="submit" class="btn btn-primary" name="new" value="New">Save</button>
                            </form>
                        </div>
                        <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                        </div>
                    </div>
                </div>
                <td><%= link_to '', samples_remove_rule_path(:rule_name => name), :class => "btn btn-danger glyphicon glyphicon-trash" %></td>
            </tbody>
        <% end %>
    </table>
    </div>
  </div>
</div>

